<%= turbo_frame_tag "contact_form" do %>
  <%= form_with(model: contact, url: create_message_path, class: "space-y-6") do |form| %>
    <%= form.hidden_field :website, value: "", class: "hidden" %>
    <%= form.hidden_field :submitted_at, value: Time.current.to_i %>
    
    <% if Rails.env.production? %>
      <%= recaptcha_tags site_key: ENV['RECAPTCHA_SITE_KEY'], 
                         theme: 'dark',
                         callback: 'enableSubmit',
                         expired_callback: 'disableSubmit' %>
    <% end %>

    <div>
      <%= form.label :name, t('contact.form.name'), class: "block text-gray-300 mb-2" %>
      <%= form.text_field :name, 
          class: "w-full px-4 py-2 rounded bg-gray-600 border border-gray-500 text-white focus:outline-none focus:border-cyan-400 #{'border-red-500' if contact&.errors&.include?(:name)}" %>
      <% if contact&.errors&.include?(:name) %>
        <p class="mt-1 text-red-500 text-sm"><%= contact.errors[:name].join(', ') %></p>
      <% end %>
    </div>

    <div>
      <%= form.label :email, t('contact.form.email'), class: "block text-gray-300 mb-2" %>
      <%= form.email_field :email, 
          class: "w-full px-4 py-2 rounded bg-gray-600 border border-gray-500 text-white focus:outline-none focus:border-cyan-400 #{'border-red-500' if contact&.errors&.include?(:email)}" %>
      <% if contact&.errors&.include?(:email) %>
        <p class="mt-1 text-red-500 text-sm"><%= contact.errors[:email].join(', ') %></p>
      <% end %>
    </div>

    <div>
      <%= form.label :subject, t('contact.form.subject'), class: "block text-gray-300 mb-2" %>
      <%= form.text_field :subject, 
          class: "w-full px-4 py-2 rounded bg-gray-600 border border-gray-500 text-white focus:outline-none focus:border-cyan-400 #{'border-red-500' if contact&.errors&.include?(:subject)}" %>
      <% if contact&.errors&.include?(:subject) %>
        <p class="mt-1 text-red-500 text-sm"><%= contact.errors[:subject].join(', ') %></p>
      <% end %>
    </div>

    <div>
      <%= form.label :message, t('contact.form.message'), class: "block text-gray-300 mb-2" %>
      <%= form.text_area :message, rows: 4, 
          class: "w-full px-4 py-2 rounded bg-gray-600 border border-gray-500 text-white focus:outline-none focus:border-cyan-400 #{'border-red-500' if contact&.errors&.include?(:message)}" %>
      <% if contact&.errors&.include?(:message) %>
        <p class="mt-1 text-red-500 text-sm"><%= contact.errors[:message].join(', ') %></p>
      <% end %>
    </div>

    <%= form.submit t('contact.form.send'), 
        class: "w-full bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded transition-colors cursor-pointer",
        id: "submit-button",
        disabled: Rails.env.production? %>
  <% end %>
<% end %>

<script>
function enableSubmit() {
  document.getElementById('submit-button').disabled = false;
}

function disableSubmit() {
  document.getElementById('submit-button').disabled = true;
}
</script>